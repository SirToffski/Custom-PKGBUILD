diff '--color=auto' --unified --recursive --text --color slippi-online-git.orig/Source/Core/VideoCommon/AVIDump.cpp slippi-online-git.new/Source/Core/VideoCommon/AVIDump.cpp
--- slippi-online-git.orig/Source/Core/VideoCommon/AVIDump.cpp	2022-03-10 21:09:00.329628475 -0400
+++ slippi-online-git.new/Source/Core/VideoCommon/AVIDump.cpp	2022-03-10 21:12:49.545002152 -0400
@@ -64,7 +64,9 @@
 	static bool first_run = true;
 	if (first_run)
 	{
+#if LIBAVCODEC_VERSION_MICRO >= 100 && LIBAVCODEC_VERSION_INT < AV_VERSION_INT(58, 9, 100)
 		av_register_all();
+#endif
 		avformat_network_init();
 		first_run = false;
 	}
@@ -158,7 +160,7 @@
 
 	File::CreateFullPath(s_dump_path);
 
-	AVOutputFormat* output_format = av_guess_format(s_format.c_str(), s_dump_path.c_str(), nullptr);
+	auto* output_format = av_guess_format(s_format.c_str(), s_dump_path.c_str(), nullptr);
 	if (!output_format)
 	{
 		ERROR_LOG(VIDEO, "Invalid format %s", s_format.c_str());
@@ -238,16 +240,16 @@
 		return false;
 	}
 
-	NOTICE_LOG(VIDEO, "Opening file %s for dumping", s_format_context->filename);
-	if (avio_open(&s_format_context->pb, s_format_context->filename, AVIO_FLAG_WRITE) < 0 ||
+	NOTICE_LOG(VIDEO, "Opening file %s for dumping", s_dump_path.c_str());
+	if (avio_open(&s_format_context->pb, s_dump_path.c_str(), AVIO_FLAG_WRITE) < 0 ||
 		avformat_write_header(s_format_context, nullptr))
 	{
-		ERROR_LOG(VIDEO, "Could not open %s", s_format_context->filename);
+		ERROR_LOG(VIDEO, "Could not open %s", s_dump_path.c_str());
 		return false;
 	}
 
-	OSD::AddMessage(StringFromFormat("Dumping Frames to \"%s\" (%dx%d)", s_format_context->filename,
-		s_width, s_height));
+	OSD::AddMessage(
+		StringFromFormat("Dumping Frames to \"%s\" (%dx%d)", s_dump_path.c_str(), s_width, s_height));
 
 	return true;
 }
